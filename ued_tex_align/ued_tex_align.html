<title>UnrealEd - Texture Alignment - Jerome Bos</title>
<script type="text/javascript">

var pi = 3.14159265;
var trigo_method = 0;
var rotation_angle_measurement = 0;
var connected_brushes_angle_measurement = 0;

function select_rotation_angle_measurement(index)
{
	rotation_angle_measurement = index;
}

function select_connected_brushes_angle_measurement(index)
{
	connected_brushes_angle_measurement = index;
}

function angle_func(num, angle_measurement)
{
	if(angle_measurement>0)
		return num * pi / 180;
	else
		return num;
}

function select_trigo_method(index)
{
	method = index;
}

function trigo_func(num)
{
	if(trigo_method>0)
		return Math.sin(num);
	else
		return Math.tan(num);
}

function calculate_panning()
{
	var sides = document.getElementById('cp_sides').value;
	var radius = document.getElementById('cp_radius').value;
	var scale = document.getElementById('cp_scale').value;

	var surface_width = 2*radius*trigo_func(pi/(sides*scale));

	document.getElementById('cp_surface_width').value = surface_width;
	document.getElementById('cp_command').value = "POLY TEXPAN U=" + surface_width;
	document.getElementById('cp_command').select();
}

function calculate_radius()
{
	var sides = document.getElementById('cr_sides').value;
	var width = document.getElementById('cr_width').value;
	var scale = document.getElementById('cr_scale').value;

	var radius = (width/sides)/(2*trigo_func(pi/(sides*scale)));

	var cr_radius = document.getElementById('cr_radius');
	cr_radius.value = radius;
	cr_radius.select();
}

function calculate_scale()
{
	var sides = document.getElementById('cs_sides').value;
	var width = document.getElementById('cs_width').value;
	var radius = document.getElementById('cs_radius').value;

	var scale = (2*radius*trigo_func(pi/sides))*sides/width;

	var cs_scale = document.getElementById('cs_scale')
	cs_scale.value = scale;
	cs_scale.select();
}

function calculate_connected_brushes()
{
	var grid = document.getElementById('connected_brushes_grid').value;
	var side_adjacent = document.getElementById('connected_brushes_side_adjacent').value*grid;
	var side_opposite = document.getElementById('connected_brushes_side_opposite').value*grid;
	var angle = angle_func(document.getElementById('connected_brushes_angle').value,connected_brushes_angle_measurement);
	var width = document.getElementById('connected_brushes_width');
	var hypotenuse = document.getElementById('connected_brushes_hypotenuse');
	var scale_adjacent = document.getElementById('connected_brushes_scale_adjacent');
	var scale_opposite = document.getElementById('connected_brushes_scale_opposite');

	var hypotenuse_calc = Math.sqrt(side_adjacent*side_adjacent+side_opposite*side_opposite);
	var width_calc = Math.cos(angle-Math.atan(side_opposite/side_adjacent))*hypotenuse_calc;

	hypotenuse.value = hypotenuse_calc;
	scale_adjacent.value = width_calc/side_adjacent;
	scale_opposite.value = width_calc/side_opposite;
	width.value = width_calc;
	width.select();
}

function calculate_rotation()
{
	var angle = angle_func(document.getElementById('rot_angle').value,rotation_angle_measurement);
	var command = document.getElementById('rot_command');
	
	var uu = Math.cos(angle);
	var uv = -Math.sin(angle);
	var vu = Math.sin(angle);
	var vv = Math.cos(angle);
	
	command.value = "POLY TEXMULT UU=" + uu + " UV=" + uv + " VU=" + vu + " VV=" + vv;
	command.select();
}
</script>

<h1>UnrealEd - Texture Alignment</h1>

<h2>1. Circular brushes</h2>

method:
<select onChange="select_trigo_method(this.selectedIndex)">
<option selected value="opt_circumscribed">circumscribed polygon</option>
<option value="opt_inscribed">inscribed polygon</option>
</select>

<h3 id="calculate_surface_width">1.1. Calculate surface width</h3>
<p>Aligning circular brushes:
<ol>
<li>Make a circular brush and apply a texture.
<li>Scale the textures.
<li>Select all surfaces that need to be aligned.
<li>Apply the calculated command.
<li>Deselect the most outward surface (either left or right).
<li>Apply the calculated command again.
<li>Repeat this method untill all surfaces are aligned.
</ol>

<p>
sides: <input type="text" id="cp_sides"><br>
radius: <input type="text" id="cp_radius"><br>
scale: <input type="text" id="cp_scale"><br>
<input type="button" value="calc" onClick="calculate_panning()"><br>
surface width: <input type="text" id="cp_surface_width" value=""><br>
command: <input type="text" id="cp_command" value=""><br>

<h3 id="calculate_radius">1.2. Calculate radius</h3>
<p>
sides: <input type="text" id="cr_sides"><br>
scale: <input type="text" id="cr_scale"><br>
texture width: <input type="text" id="cr_width"><br>
<input type="button" value="calc" onClick="calculate_radius()"><br>
radius: <input type="text" id="cr_radius" value=""><br>

<h3 id="calculate_scale">1.3. Calculate scale</h3>
<p>
sides: <input type="text" id="cs_sides"><br>
texture width: <input type="text" id="cs_width"><br>
radius: <input type="text" id="cs_radius"><br>
<input type="button" value="calc" onClick="calculate_scale()"><br>
scale: <input type="text" id="cs_scale" value=""><br>

<h2 id="connected_brushes">2. Connected brushes</h2>
grid: <input type="text" id="connected_brushes_grid" value="16"><br>
adjacent side: <input type="text" id="connected_brushes_side_adjacent"><br>
opposite side: <input type="text" id="connected_brushes_side_opposite"><br>
angle: <input type="text" id="connected_brushes_angle" value="">
<select onChange="select_connected_brushes_angle_measurement(this.selectedIndex)">
<option selected value="connected_brushes_opt_radians">radians</option>
<option value="connected_brushes_opt_degrees">degrees</option>
</select><br>
<input type="button" value="calc" onClick="calculate_connected_brushes()"><br>
hypotenuse: <input type="text" id="connected_brushes_hypotenuse"><br>
width: <input type="text" id="connected_brushes_width"><br>
scale adjacent: <input type="text" id="connected_brushes_scale_adjacent" value=""><br>
scale opposite: <input type="text" id="connected_brushes_scale_opposite" value=""><br>

<h2 id="rotation">3. Rotation</h2>
angle: <input type="text" id="rot_angle" value="">
<select onChange="select_rotation_angle_measurement(this.selectedIndex)">
<option selected value="rot_opt_radians">radians</option>
<option value="rot_opt_degrees">degrees</option>
</select><br>
<input type="button" value="calc" onClick="calculate_rotation()"><br>
command: <input type="text" id="rot_command" value=""><br>

<!-- by Jerome Bos -->